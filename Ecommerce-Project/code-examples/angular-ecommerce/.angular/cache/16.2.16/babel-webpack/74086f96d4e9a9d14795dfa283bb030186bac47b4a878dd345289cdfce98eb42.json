{"ast":null,"code":"import { map, take } from 'rxjs/operators';\nimport { selectIsAuthenticated } from '../../store/selectors/auth.selectors';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ngrx/store\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/notification.service\";\nclass AuthGuard {\n  constructor(store, router, notificationService) {\n    this.store = store;\n    this.router = router;\n    this.notificationService = notificationService;\n  }\n  canActivate(route, state) {\n    return this.store.select(selectIsAuthenticated).pipe(take(1), map(isAuthenticated => {\n      if (isAuthenticated) {\n        return true;\n      }\n      this.notificationService.info('Please login to access this page');\n      return this.router.createUrlTree(['/auth/login'], {\n        queryParams: {\n          returnUrl: state.url\n        }\n      });\n    }));\n  }\n  static {\n    this.ɵfac = function AuthGuard_Factory(t) {\n      return new (t || AuthGuard)(i0.ɵɵinject(i1.Store), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.NotificationService));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AuthGuard,\n      factory: AuthGuard.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}\nexport { AuthGuard };","map":{"version":3,"names":["map","take","selectIsAuthenticated","AuthGuard","constructor","store","router","notificationService","canActivate","route","state","select","pipe","isAuthenticated","info","createUrlTree","queryParams","returnUrl","url","i0","ɵɵinject","i1","Store","i2","Router","i3","NotificationService","factory","ɵfac","providedIn"],"sources":["/Users/stephanelkhoury/Documents/GitHub/Angular-masterclass/25-Ecommerce-Project/code-examples/angular-ecommerce/src/app/core/guards/auth.guard.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { CanActivate, ActivatedRouteSnapshot, RouterStateSnapshot, Router, UrlTree } from '@angular/router';\nimport { Observable } from 'rxjs';\nimport { map, take } from 'rxjs/operators';\nimport { Store } from '@ngrx/store';\n\nimport { AppState } from '../../store';\nimport { selectIsAuthenticated } from '../../store/selectors/auth.selectors';\nimport { NotificationService } from '../services/notification.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthGuard implements CanActivate {\n  \n  constructor(\n    private store: Store<AppState>,\n    private router: Router,\n    private notificationService: NotificationService\n  ) {}\n\n  canActivate(\n    route: ActivatedRouteSnapshot,\n    state: RouterStateSnapshot\n  ): Observable<boolean | UrlTree> | Promise<boolean | UrlTree> | boolean | UrlTree {\n    \n    return this.store.select(selectIsAuthenticated).pipe(\n      take(1),\n      map(isAuthenticated => {\n        if (isAuthenticated) {\n          return true;\n        }\n        \n        this.notificationService.info('Please login to access this page');\n        return this.router.createUrlTree(['/auth/login'], {\n          queryParams: { returnUrl: state.url }\n        });\n      })\n    );\n  }\n}\n"],"mappings":"AAGA,SAASA,GAAG,EAAEC,IAAI,QAAQ,gBAAgB;AAI1C,SAASC,qBAAqB,QAAQ,sCAAsC;;;;;AAG5E,MAGaC,SAAS;EAEpBC,YACUC,KAAsB,EACtBC,MAAc,EACdC,mBAAwC;IAFxC,KAAAF,KAAK,GAALA,KAAK;IACL,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,mBAAmB,GAAnBA,mBAAmB;EAC1B;EAEHC,WAAWA,CACTC,KAA6B,EAC7BC,KAA0B;IAG1B,OAAO,IAAI,CAACL,KAAK,CAACM,MAAM,CAACT,qBAAqB,CAAC,CAACU,IAAI,CAClDX,IAAI,CAAC,CAAC,CAAC,EACPD,GAAG,CAACa,eAAe,IAAG;MACpB,IAAIA,eAAe,EAAE;QACnB,OAAO,IAAI;;MAGb,IAAI,CAACN,mBAAmB,CAACO,IAAI,CAAC,kCAAkC,CAAC;MACjE,OAAO,IAAI,CAACR,MAAM,CAACS,aAAa,CAAC,CAAC,aAAa,CAAC,EAAE;QAChDC,WAAW,EAAE;UAAEC,SAAS,EAAEP,KAAK,CAACQ;QAAG;OACpC,CAAC;IACJ,CAAC,CAAC,CACH;EACH;;;uBA1BWf,SAAS,EAAAgB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,KAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,MAAA,GAAAL,EAAA,CAAAC,QAAA,CAAAK,EAAA,CAAAC,mBAAA;IAAA;EAAA;;;aAATvB,SAAS;MAAAwB,OAAA,EAATxB,SAAS,CAAAyB,IAAA;MAAAC,UAAA,EAFR;IAAM;EAAA;;SAEP1B,SAAS","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}