{"ast":null,"code":"import { BehaviorSubject, map, of } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./storage.service\";\nlet WishlistService = /*#__PURE__*/(() => {\n  class WishlistService {\n    constructor(storageService) {\n      this.storageService = storageService;\n      this.WISHLIST_KEY = 'ecommerce_wishlist';\n      this.wishlistSubject = new BehaviorSubject([]);\n      this.wishlist$ = this.wishlistSubject.asObservable();\n      this.wishlistCount$ = this.wishlist$.pipe(map(items => items.length));\n      this.loadWishlist();\n    }\n    loadWishlist() {\n      const savedWishlist = this.storageService.getItem(this.WISHLIST_KEY);\n      if (savedWishlist && Array.isArray(savedWishlist)) {\n        this.wishlistSubject.next(savedWishlist);\n      }\n    }\n    saveWishlist() {\n      this.storageService.setItem(this.WISHLIST_KEY, this.wishlistSubject.value);\n    }\n    addToWishlist(product) {\n      const currentWishlist = this.wishlistSubject.value;\n      const existingIndex = currentWishlist.findIndex(item => item.id === product.id);\n      if (existingIndex === -1) {\n        const updatedWishlist = [...currentWishlist, product];\n        this.wishlistSubject.next(updatedWishlist);\n        this.saveWishlist();\n      }\n    }\n    removeFromWishlist(productId) {\n      const currentWishlist = this.wishlistSubject.value;\n      const updatedWishlist = currentWishlist.filter(item => item.id !== productId);\n      this.wishlistSubject.next(updatedWishlist);\n      this.saveWishlist();\n    }\n    isInWishlist(productId) {\n      return this.wishlist$.pipe(map(items => items.some(item => item.id === productId)));\n    }\n    clearWishlist() {\n      this.wishlistSubject.next([]);\n      this.saveWishlist();\n    }\n    getWishlist() {\n      return this.wishlistSubject.value;\n    }\n    // Toggles item and returns an observable indicating the new state (e.g., true if added, false if removed)\n    toggleWishlist(productId) {\n      let currentWishlist = this.getWishlist();\n      const productIndex = currentWishlist.findIndex(item => item.id === productId);\n      let added;\n      if (productIndex > -1) {\n        currentWishlist.splice(productIndex, 1); // Remove from wishlist\n        added = false;\n      } else {\n        const product = {\n          id: productId\n        }; // Create a product object with at least the id\n        currentWishlist = [...currentWishlist, product]; // Add to wishlist\n        added = true;\n      }\n      this.wishlistSubject.next(currentWishlist);\n      this.saveWishlist();\n      return of(added); // Simulate async operation and return new state\n    }\n\n    static {\n      this.ɵfac = function WishlistService_Factory(t) {\n        return new (t || WishlistService)(i0.ɵɵinject(i1.StorageService));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: WishlistService,\n        factory: WishlistService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return WishlistService;\n})();\nexport { WishlistService };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}