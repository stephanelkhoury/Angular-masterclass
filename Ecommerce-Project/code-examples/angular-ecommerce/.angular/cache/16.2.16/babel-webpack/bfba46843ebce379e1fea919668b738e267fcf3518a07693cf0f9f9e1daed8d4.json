{"ast":null,"code":"import { environment } from '../../../environments/environment';\nimport { addToCart, removeFromCart, updateCartItemQuantity } from '../../store/actions/cart.actions';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@ngrx/store\";\nclass CartService {\n  constructor(http, store) {\n    this.http = http;\n    this.store = store;\n    this.apiUrl = `${environment.apiUrl}/cart`;\n  }\n  loadCart() {\n    return this.http.get(this.apiUrl);\n  }\n  getCart() {\n    return this.http.get(this.apiUrl);\n  }\n  addToCart(product, quantity = 1) {\n    const cartItem = {\n      productId: product.id,\n      quantity: quantity,\n      name: product.name,\n      price: product.discountPrice || product.price,\n      unitPrice: product.discountPrice || product.price,\n      image: product.imageUrl,\n      imageUrl: product.imageUrl\n    };\n    this.store.dispatch(addToCart({\n      item: cartItem\n    }));\n  }\n  getCartItems() {\n    return this.http.get(this.apiUrl);\n  }\n  removeFromCart(id) {\n    this.store.dispatch(removeFromCart({\n      productId: id\n    }));\n  }\n  updateQuantity(id, quantity) {\n    this.store.dispatch(updateCartItemQuantity({\n      productId: id,\n      quantity\n    }));\n  }\n  clearCart() {\n    this.http.delete(`${this.apiUrl}/clear`).subscribe();\n  }\n  syncCart(items) {\n    return this.http.post(`${this.apiUrl}/sync`, {\n      items\n    });\n  }\n  static {\n    this.ɵfac = function CartService_Factory(t) {\n      return new (t || CartService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Store));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: CartService,\n      factory: CartService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}\nexport { CartService };","map":{"version":3,"names":["environment","addToCart","removeFromCart","updateCartItemQuantity","CartService","constructor","http","store","apiUrl","loadCart","get","getCart","product","quantity","cartItem","productId","id","name","price","discountPrice","unitPrice","image","imageUrl","dispatch","item","getCartItems","updateQuantity","clearCart","delete","subscribe","syncCart","items","post","i0","ɵɵinject","i1","HttpClient","i2","Store","factory","ɵfac","providedIn"],"sources":["/Users/stephanelkhoury/Documents/GitHub/Angular-masterclass/Ecommerce-Project/code-examples/angular-ecommerce/src/app/core/services/cart.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Observable, of } from 'rxjs';\nimport { Store } from '@ngrx/store';\n\nimport { environment } from '../../../environments/environment';\nimport { Product } from '../models/product.model';\nimport { CartItem } from '../models/cart.model'; // Import CartItem\nimport { AppState } from '../../store';\nimport { addToCart, removeFromCart, updateCartItemQuantity } from '../../store/actions/cart.actions';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class CartService {\n  private apiUrl = `${environment.apiUrl}/cart`;\n\n  constructor(\n    private http: HttpClient,\n    private store: Store<AppState>\n  ) {}\n\n  loadCart(): Observable<CartItem[]> {\n    return this.http.get<CartItem[]>(this.apiUrl);\n  }\n\n  getCart(): Observable<CartItem[]> {\n    return this.http.get<CartItem[]>(this.apiUrl);\n  }\n\n  addToCart(product: Product, quantity: number = 1): void {\n    const cartItem: CartItem = {\n      productId: product.id,\n      quantity: quantity,\n      name: product.name,\n      price: product.discountPrice || product.price,\n      unitPrice: product.discountPrice || product.price,\n      image: product.imageUrl,\n      imageUrl: product.imageUrl\n    };\n    this.store.dispatch(addToCart({ item: cartItem }));\n  }\n\n  getCartItems(): Observable<CartItem[]> {\n    return this.http.get<CartItem[]>(this.apiUrl);\n  }\n\n  removeFromCart(id: string): void { // id is productId\n    this.store.dispatch(removeFromCart({ productId: id }));\n  }\n\n  updateQuantity(id: string, quantity: number): void { // id is productId\n    this.store.dispatch(updateCartItemQuantity({ productId: id, quantity }));\n  }\n\n  clearCart(): void {\n    this.http.delete<void>(`${this.apiUrl}/clear`).subscribe();\n  }\n\n  syncCart(items: CartItem[]): Observable<void> {\n    return this.http.post<void>(`${this.apiUrl}/sync`, { items });\n  }\n}\n"],"mappings":"AAKA,SAASA,WAAW,QAAQ,mCAAmC;AAI/D,SAASC,SAAS,EAAEC,cAAc,EAAEC,sBAAsB,QAAQ,kCAAkC;;;;AAEpG,MAGaC,WAAW;EAGtBC,YACUC,IAAgB,EAChBC,KAAsB;IADtB,KAAAD,IAAI,GAAJA,IAAI;IACJ,KAAAC,KAAK,GAALA,KAAK;IAJP,KAAAC,MAAM,GAAG,GAAGR,WAAW,CAACQ,MAAM,OAAO;EAK1C;EAEHC,QAAQA,CAAA;IACN,OAAO,IAAI,CAACH,IAAI,CAACI,GAAG,CAAa,IAAI,CAACF,MAAM,CAAC;EAC/C;EAEAG,OAAOA,CAAA;IACL,OAAO,IAAI,CAACL,IAAI,CAACI,GAAG,CAAa,IAAI,CAACF,MAAM,CAAC;EAC/C;EAEAP,SAASA,CAACW,OAAgB,EAAEC,QAAA,GAAmB,CAAC;IAC9C,MAAMC,QAAQ,GAAa;MACzBC,SAAS,EAAEH,OAAO,CAACI,EAAE;MACrBH,QAAQ,EAAEA,QAAQ;MAClBI,IAAI,EAAEL,OAAO,CAACK,IAAI;MAClBC,KAAK,EAAEN,OAAO,CAACO,aAAa,IAAIP,OAAO,CAACM,KAAK;MAC7CE,SAAS,EAAER,OAAO,CAACO,aAAa,IAAIP,OAAO,CAACM,KAAK;MACjDG,KAAK,EAAET,OAAO,CAACU,QAAQ;MACvBA,QAAQ,EAAEV,OAAO,CAACU;KACnB;IACD,IAAI,CAACf,KAAK,CAACgB,QAAQ,CAACtB,SAAS,CAAC;MAAEuB,IAAI,EAAEV;IAAQ,CAAE,CAAC,CAAC;EACpD;EAEAW,YAAYA,CAAA;IACV,OAAO,IAAI,CAACnB,IAAI,CAACI,GAAG,CAAa,IAAI,CAACF,MAAM,CAAC;EAC/C;EAEAN,cAAcA,CAACc,EAAU;IACvB,IAAI,CAACT,KAAK,CAACgB,QAAQ,CAACrB,cAAc,CAAC;MAAEa,SAAS,EAAEC;IAAE,CAAE,CAAC,CAAC;EACxD;EAEAU,cAAcA,CAACV,EAAU,EAAEH,QAAgB;IACzC,IAAI,CAACN,KAAK,CAACgB,QAAQ,CAACpB,sBAAsB,CAAC;MAAEY,SAAS,EAAEC,EAAE;MAAEH;IAAQ,CAAE,CAAC,CAAC;EAC1E;EAEAc,SAASA,CAAA;IACP,IAAI,CAACrB,IAAI,CAACsB,MAAM,CAAO,GAAG,IAAI,CAACpB,MAAM,QAAQ,CAAC,CAACqB,SAAS,EAAE;EAC5D;EAEAC,QAAQA,CAACC,KAAiB;IACxB,OAAO,IAAI,CAACzB,IAAI,CAAC0B,IAAI,CAAO,GAAG,IAAI,CAACxB,MAAM,OAAO,EAAE;MAAEuB;IAAK,CAAE,CAAC;EAC/D;;;uBA/CW3B,WAAW,EAAA6B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,KAAA;IAAA;EAAA;;;aAAXlC,WAAW;MAAAmC,OAAA,EAAXnC,WAAW,CAAAoC,IAAA;MAAAC,UAAA,EAFV;IAAM;EAAA;;SAEPrC,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}